test-ingestion:
  description: "Test ingestion by spawning a local instance of the ska-src-ingestion service."
  module_name: "tasks.tests.ingestion"
  class_name: "TestIngestionLocal"
  enabled: true
  args:
  kwargs:
    task_name: "ingestion_test"
    n_files: 3
    scope: "testing"
    datasetName: "magenta"
    lifetime: 3600
    prefix: "test1"
    sizes: 1000
    ingest_dir: "/tmp/ingest"
    # ingestion_meta_schema: |-
    #   {
    #     <overrides etc/schemas/ingestion_metadata.json>
    #   }
    ingestion_meta_suffix: meta
    ingestion_backend_name: rucio
    ingestion_polling_frequency_s: 5
    ingestion_iteration_batch_size: 100
    rucio_ingest_rse_name: STFC_STORM
    n_retries: 5
    delay_s: 5
    obscore_metadata:
      calib_level: 0
      obs_collection: "test"
      obs_id: "test"
      obs_publisher_did: "test"
      access_url: "https://ivoa.datalink.srcdev.skao.int/rucio/links?id="
    output:
      databases:
        - type: es
          uri: https://monit.srcdev.skao.int:443/elastic
          index: rucio-task-manager.skao-dev.tasks.tests.ingestion
